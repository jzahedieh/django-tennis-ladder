{% extends 'base.html' %}
{% load ladder_extras %}
{% load render_table from django_tables2 %}


{% block container %}
<link rel="stylesheet" type="text/css" href="/static/css/theme.ice.css" />
<link rel="stylesheet" type="text/css" href="/static/css/ladder.css" />
<script type="text/javascript" src="/static/js/jquery.tablesorter.min.js"></script>
<script type="text/javascript" src="/static/js/jquery.metadata.js"></script>

<script type="text/javascript">
$(document).ready(function()
    {
        $("#ladderTable").tablesorter({
            theme: 'ice'
        });
    }
);
</script>

<h1> {{ ladder }} </h1>
<h3>{{ ladder.season.start_date }} to {{ ladder.season.end_date }}</h3>
    <a href="javascript:history.go(-1)">Back</a>

    <span class="score_error" style="color:red; font-weight: bold; display: none">* Flagged as inaccurate, please double check physical copy.</span>

    {% render_table table %}

    <div class="row">
        <div class="span6">
            <h2>{{ current_season }} Stats</h2>
            <table class="table">
                    <tr><td>Total Matches in Division</td><td>{{ ladder.get_stats.total_matches }}</td></tr>
                    <tr><td>Total Matches Played</td><td>{{ ladder.get_stats.total_matches_played|floatformat:"0" }}</td></tr>
                    <tr><td>Percentage Matches Played</td><td>{{ ladder.get_stats.perc_matches_played|floatformat:"2" }}%</td></tr>
            </table>
        </div>
        <div class="span6">
            <h2>Latest Results</h2>
            <table class="table table-condensed">
                <th>Player</th>
                <th>Result</th>
                <th></th>
                <th>Result</th>
                <th>Player</th>
                <th>Date Added</th>
                {% for key, value in ladder.get_latest_results %}
                    <tr>
                        <td>{{ value.player }}</td>
                        <td style="text-align: center;">{{ value.player_result }}</td>
                        <td>vs</td>
                        <td style="text-align: center;">{{ value.opponent_result }}</td>
                        <td>{{ value.opponent }}</td>
                        <td>{{ value.date_added }}</td>
                    </tr>
                {% endfor %}
            </table>
        </div>
    </div>

    <script type="text/javascript">

        $(document).ready(function () {
                    $(".selectable").hover(function () {
                        opponentSelector(this).css("background-color", "#eee")
                    }, function () {
                        opponentSelector(this).css("background-color", "");
                    });

                }
        );
        function opponentSelector(element) {
            return $('td[data-player=' + $(element).data('opp') + '][data-opp=' + $(element).data('player') + ']');
        }
    </script>

{% endblock %}